<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Genopoisk ‚Äî –°–º–æ—Ç—Ä–∏ —Ñ–∏–ª—å–º—ã –≤ —Ö–æ—Ä–æ—à–µ–º –∫–∞—á–µ—Å—Ç–≤–µ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta
    name="description"
    content="Genopoisk ‚Äî –∫–∞—Ç–∞–ª–æ–≥ –ª—É—á—à–∏—Ö —Ñ–∏–ª—å–º–æ–≤, –æ–Ω–ª–∞–π–Ω-–ø–æ–∏—Å–∫ –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä –±–µ–∑ –ª–∏—à–Ω–µ–π —Ä–µ–∫–ª–∞–º—ã!"
  />

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      background: radial-gradient(circle at top, #1f2937 0, #030712 55%);
      color: #f9fafb;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    .app {
      max-width: 1200px;
      margin: 0 auto;
      padding: 16px 16px 40px;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    header {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .logo-row {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      gap: 8px;
      flex-wrap: wrap;
    }

    .logo-title {
      font-size: 1.6rem;
      font-weight: 700;
      letter-spacing: 0.02em;
    }

    .logo-highlight {
      color: #22c55e;
    }

    .logo-subtitle {
      font-size: 0.9rem;
      color: #9ca3af;
    }

    .search-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 8px;
    }

    .search-input-wrap {
      flex: 1 1 220px;
      position: relative;
    }

    .search-input {
      width: 100%;
      padding: 10px 38px 10px 12px;
      border-radius: 999px;
      border: 1px solid #374151;
      background: rgba(17, 24, 39, 0.9);
      color: #f9fafb;
      font-size: 0.95rem;
      outline: none;
      transition: border-color 0.15s ease, box-shadow 0.15s ease,
        background 0.15s ease;
    }

    .search-input::placeholder {
      color: #6b7280;
    }

    .search-input:focus {
      border-color: #22c55e;
      box-shadow: 0 0 0 1px rgba(34, 197, 94, 0.4);
      background: rgba(15, 23, 42, 0.98);
    }

    .search-button {
      position: absolute;
      right: 4px;
      top: 50%;
      transform: translateY(-50%);
      border-radius: 999px;
      border: none;
      padding: 6px 12px;
      background: linear-gradient(135deg, #22c55e, #4ade80);
      color: #022c22;
      font-size: 0.8rem;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 6px;
      box-shadow: 0 2px 6px rgba(34, 197, 94, 0.3);
      transition: transform 0.15s ease, box-shadow 0.15s ease,
        background 0.15s ease;
      white-space: nowrap;
    }

    .search-button:hover {
      transform: translateY(-50%) translateY(-1px);
      box-shadow: 0 4px 12px rgba(34, 197, 94, 0.4);
    }

    .search-button:active {
      transform: translateY(-50%) translateY(0);
      box-shadow: 0 1px 4px rgba(34, 197, 94, 0.35);
    }

    .search-button-icon {
      font-size: 1rem;
      line-height: 1;
    }

    .chips-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 6px;
    }

    .chip {
      flex: 0 0 auto;
      border-radius: 999px;
      padding: 7px 14px;
      font-size: 0.82rem;
      font-weight: 500;
      border: 1px solid rgba(55, 65, 81, 0.9);
      background: rgba(17, 24, 39, 0.85);
      color: #e5e7eb;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: background 0.15s ease, border-color 0.15s ease,
        transform 0.1s ease, color 0.15s ease;
      backdrop-filter: blur(8px);
    }

    .chip span.icon {
      font-size: 0.9rem;
    }

    .chip-primary {
      border-color: rgba(34, 197, 94, 0.25);
      color: #bbf7d0;
    }

    .chip:hover {
      background: rgba(31, 41, 55, 0.95);
      border-color: rgba(148, 163, 184, 0.8);
      transform: translateY(-1px);
    }

    .chip:active {
      transform: translateY(0);
    }

    .chip-active {
      background: linear-gradient(135deg, #22c55e, #15803d);
      border-color: transparent;
      color: #ecfdf5;
      box-shadow: 0 2px 10px rgba(34, 197, 94, 0.4);
    }

    main {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .status-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
      font-size: 0.8rem;
      color: #9ca3af;
    }

    .status-left {
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .status-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.25);
    }

    .status-right {
      opacity: 0.9;
    }

    .status-strong {
      color: #e5e7eb;
      font-weight: 500;
    }

    .grid-wrapper {
      position: relative;
      border-radius: 16px;
      padding: 14px 10px 10px;
      background: radial-gradient(circle at top left, #1f2937 0, #020617 55%);
      border: 1px solid rgba(31, 41, 55, 0.9);
      box-shadow: 0 14px 45px rgba(15, 23, 42, 0.9),
        0 10px 20px rgba(15, 23, 42, 0.7);
      min-height: 140px;
    }

    .grid-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 8px;
      padding: 0 4px;
    }

    .grid-title {
      font-size: 0.95rem;
      font-weight: 600;
    }

    .grid-counter {
      font-size: 0.8rem;
      color: #9ca3af;
    }

    .movies-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 10px;
    }

    @media (max-width: 640px) {
      .movies-grid {
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      }
    }

    .movie-card {
      position: relative;
      border-radius: 12px;
      overflow: hidden;
      background: #020617;
      border: 1px solid rgba(31, 41, 55, 0.9);
      display: flex;
      flex-direction: column;
      min-height: 210px;
      box-shadow: 0 6px 20px rgba(15, 23, 42, 0.7);
      transition: transform 0.16s ease, box-shadow 0.16s ease,
        border-color 0.16s ease;
      cursor: pointer;
    }

    .movie-card:hover {
      transform: translateY(-3px);
      border-color: rgba(148, 163, 184, 0.8);
      box-shadow: 0 14px 35px rgba(15, 23, 42, 0.95);
    }

    .movie-poster-wrap {
      position: relative;
      width: 100%;
      padding-top: 145%;
      background: radial-gradient(circle at top, #111827 0, #020617 60%);
      overflow: hidden;
    }

    .movie-poster {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      transform: scale(1.02);
      transition: transform 0.35s ease, filter 0.35s ease, opacity 0.25s ease;
      filter: saturate(1.05) contrast(1.02);
    }

    .movie-card:hover .movie-poster {
      transform: scale(1.06);
      filter: saturate(1.1) contrast(1.03);
    }

    .movie-gradient {
      position: absolute;
      left: 0;
      right: 0;
      bottom: 0;
      height: 52%;
      background: linear-gradient(
        to top,
        rgba(15, 23, 42, 0.96),
        rgba(15, 23, 42, 0.88),
        transparent
      );
      pointer-events: none;
    }

    .movie-rating-pill {
      position: absolute;
      top: 8px;
      left: 8px;
      padding: 3px 7px;
      border-radius: 999px;
      font-size: 0.7rem;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      background: rgba(15, 23, 42, 0.86);
      color: #e5e7eb;
      border: 1px solid rgba(31, 41, 55, 0.95);
      backdrop-filter: blur(10px);
    }

    .movie-rating-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
    }

    .rating-high {
      background: linear-gradient(135deg, #22c55e, #16a34a);
      box-shadow: 0 0 0 2px rgba(22, 163, 74, 0.6);
    }

    .rating-mid {
      background: linear-gradient(135deg, #eab308, #f97316);
      box-shadow: 0 0 0 2px rgba(234, 179, 8, 0.6);
    }

    .rating-low {
      background: linear-gradient(135deg, #ef4444, #b91c1c);
      box-shadow: 0 0 0 2px rgba(239, 68, 68, 0.5);
    }

    .movie-info {
      padding: 8px 9px 9px;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .movie-title {
      font-size: 0.87rem;
      font-weight: 600;
      color: #f9fafb;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .movie-meta {
      font-size: 0.75rem;
      color: #9ca3af;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 6px;
    }

    .movie-year {
      opacity: 0.9;
    }

    .movie-genre {
      text-align: right;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .loader {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(
        circle at top,
        rgba(17, 24, 39, 0.9),
        rgba(3, 7, 18, 0.98)
      );
      backdrop-filter: blur(12px);
      z-index: 5;
      transition: opacity 0.2s ease, visibility 0.2s ease;
    }

    .loader.hidden {
      opacity: 0;
      visibility: hidden;
      pointer-events: none;
    }

    .loader-inner {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      color: #e5e7eb;
      font-size: 0.9rem;
    }

    .loader-dots {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .loader-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: #22c55e;
      opacity: 0.5;
      animation: pulse 0.9s infinite ease-in-out;
    }

    .loader-dot:nth-child(2) {
      animation-delay: 0.1s;
    }

    .loader-dot:nth-child(3) {
      animation-delay: 0.2s;
    }

    @keyframes pulse {
      0% {
        opacity: 0.25;
        transform: translateY(0);
      }
      50% {
        opacity: 1;
        transform: translateY(-3px);
      }
      100% {
        opacity: 0.25;
        transform: translateY(0);
      }
    }

    .error-banner {
      position: absolute;
      left: 50%;
      bottom: 8px;
      transform: translateX(-50%);
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(239, 68, 68, 0.12);
      border: 1px solid rgba(248, 113, 113, 0.8);
      color: #fecaca;
      font-size: 0.78rem;
      display: flex;
      align-items: center;
      gap: 6px;
      backdrop-filter: blur(12px);
      box-shadow: 0 8px 30px rgba(15, 23, 42, 0.9);
    }

    .error-banner.hidden {
      display: none;
    }

    .error-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: #f97316;
      box-shadow: 0 0 0 2px rgba(248, 113, 113, 0.5);
    }

    footer {
      margin-top: auto;
      padding: 10px 16px 14px;
      font-size: 0.75rem;
      color: #6b7280;
      text-align: center;
    }

    footer span.accent {
      color: #9ca3af;
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="logo-row">
        <div>
          <div class="logo-title">
            Geno<span class="logo-highlight">poisk</span>
          </div>
          <div class="logo-subtitle">
            –ö–∞—Ç–∞–ª–æ–≥ –ª—É—á—à–∏—Ö —Ñ–∏–ª—å–º–æ–≤, –æ–Ω–ª–∞–π–Ω-–ø–æ–∏—Å–∫ –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä –±–µ–∑ –ª–∏—à–Ω–µ–π —Ä–µ–∫–ª–∞–º—ã!
          </div>
        </div>
      </div>

      <div class="search-row">
        <div class="search-input-wrap">
          <input
            id="search-input"
            type="text"
            class="search-input"
            placeholder="–ù–∞–π—Ç–∏ —Ñ–∏–ª—å–º –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é, ID –∏–ª–∏ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º—É –∏–º–µ–Ω–∏‚Ä¶"
          />
          <button id="search-button" class="search-button">
            <span class="search-button-icon">üîç</span>
            <span>–ù–∞–π—Ç–∏</span>
          </button>
        </div>
      </div>

      <div class="chips-row">
        <button id="btn-popular" class="chip chip-primary">
          <span class="icon">üî•</span>
          <span>–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ</span>
        </button>
        <button id="btn-top250" class="chip">
          <span class="icon">üèÜ</span>
          <span>–¢–æ–ø 250</span>
        </button>
        <button id="btn-new" class="chip">
          <span class="icon">üÜï</span>
          <span>–ù–æ–≤–∏–Ω–∫–∏</span>
        </button>
        <button id="btn-random" class="chip">
          <span class="icon">üé≤</span>
          <span>–°–ª—É—á–∞–π–Ω—ã–π</span>
        </button>
      </div>
    </header>

    <main>
      <div class="status-row">
        <div class="status-left">
          <span class="status-dot"></span>
          <span>–ì–æ—Ç–æ–≤ –∫ –ø–æ–∏—Å–∫—É –∫–∏–Ω–æ</span>
        </div>
        <div class="status-right">
          API: <span class="status-strong">PoiskKino.dev</span>
        </div>
      </div>

      <div class="grid-wrapper">
        <div id="loader" class="loader hidden">
          <div class="loader-inner">
            <div class="loader-dots">
              <div class="loader-dot"></div>
              <div class="loader-dot"></div>
              <div class="loader-dot"></div>
            </div>
            <div>–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∏–ª—å–º–æ–≤‚Ä¶</div>
          </div>
        </div>

        <div id="error-banner" class="error-banner hidden">
          <div class="error-dot"></div>
          <div id="error-text">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö</div>
        </div>

        <div class="grid-header">
          <div class="grid-title" id="grid-title">–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ñ–∏–ª—å–º—ã</div>
          <div class="grid-counter" id="grid-counter">0 –Ω–∞–π–¥–µ–Ω–æ</div>
        </div>

        <div id="movies" class="movies-grid"></div>
      </div>
    </main>
  </div>

  <footer>
    Genopoisk ¬∑ –∫–∏–Ω–æ –ø–æ –¥–∞–Ω–Ω—ã–º <span class="accent">PoiskKino / Kinopoisk.dev</span>
  </footer>

  <script>
    const API_KEY = "CRDEV06-M84M476-HQX2THM-RHFSWX0";
    const API_BASE = "https://api.poiskkino.dev";

    const searchInput = document.getElementById("search-input");
    const searchButton = document.getElementById("search-button");
    const btnPopular = document.getElementById("btn-popular");
    const btnTop250 = document.getElementById("btn-top250");
    const btnNew = document.getElementById("btn-new");
    const btnRandom = document.getElementById("btn-random");

    const moviesContainer = document.getElementById("movies");
    const loader = document.getElementById("loader");
    const errorBanner = document.getElementById("error-banner");
    const errorText = document.getElementById("error-text");
    const gridTitle = document.getElementById("grid-title");
    const gridCounter = document.getElementById("grid-counter");

    let currentCategory = "popular";

    function setActiveChip(button) {
      [btnPopular, btnTop250, btnNew, btnRandom].forEach((btn) =>
        btn.classList.remove("chip-active")
      );
      if (button) {
        button.classList.add("chip-active");
      }
    }

    function showLoader() {
      loader.classList.remove("hidden");
    }

    function hideLoader() {
      loader.classList.add("hidden");
    }

    function showError(message) {
      errorText.textContent = message || "–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö";
      errorBanner.classList.remove("hidden");
      setTimeout(() => {
        errorBanner.classList.add("hidden");
      }, 3500);
    }

    async function apiRequest(path, params = {}) {
      const url = new URL(API_BASE + path);

      Object.entries(params).forEach(([key, value]) => {
        if (value === undefined || value === null || value === "") return;
        url.searchParams.set(key, value);
      });

      const res = await fetch(url.toString(), {
        method: "GET",
        headers: {
          "X-API-KEY": API_KEY,
          accept: "application/json",
        },
      });

      if (!res.ok) {
        throw new Error("API error " + res.status);
      }

      return res.json();
    }

    async function searchMoviesByName(query, page = 1, limit = 24) {
      return apiRequest("/v1.4/movie/search", {
        query,
        page,
        limit,
      });
    }

    async function getMoviesList(filters = {}, page = 1, limit = 24) {
      return apiRequest("/v1.4/movie", {
        page,
        limit,
        ...filters,
      });
    }

    async function getRandomMovie() {
      // –ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏ —Å kinopoisk.dev ‚Äî random –∏–∑ –∫–æ–ª–ª–µ–∫—Ü–∏–π
      return apiRequest("/v1.4/movie/random", {
        // –º–æ–∂–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–æ–ª—å–∫–æ —Ñ–∏–ª—å–º–∞–º–∏
        // type: "movie"
      });
    }

    function getRatingClass(value) {
      if (value === null || value === undefined) return "rating-mid";
      if (value >= 7.5) return "rating-high";
      if (value >= 5.5) return "rating-mid";
      return "rating-low";
    }

    function renderMovies(docs) {
      moviesContainer.innerHTML = "";

      if (!docs || !docs.length) {
        const empty = document.createElement("div");
        empty.style.padding = "10px 12px 6px";
        empty.style.fontSize = "0.88rem";
        empty.style.color = "#9ca3af";
        empty.textContent = "–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å –∏–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—é.";
        moviesContainer.appendChild(empty);
        gridCounter.textContent = "0 –Ω–∞–π–¥–µ–Ω–æ";
        return;
      }

      docs.forEach((movie) => {
        const card = document.createElement("div");
        card.className = "movie-card";

        const posterUrl =
          movie.poster?.url ||
          movie.backdrop?.url ||
          "https://via.placeholder.com/300x450/020617/4b5563?text=No+Image";

        const ratingKp =
          movie.rating?.kp !== undefined && movie.rating?.kp !== null
            ? Number(movie.rating.kp.toFixed(1))
            : null;

        const genres = Array.isArray(movie.genres)
          ? movie.genres.map((g) => g.name).filter(Boolean)
          : [];

        card.innerHTML = `
          <div class="movie-poster-wrap">
            <img class="movie-poster" src="${posterUrl}" loading="lazy" alt="${(movie.name || movie.alternativeName || "–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è")
          .toString()
          .replace(/"/g, "&quot;")}" />
            <div class="movie-gradient"></div>
            ${
              ratingKp
                ? `
              <div class="movie-rating-pill">
                <span class="movie-rating-dot ${getRatingClass(
                  ratingKp
                )}"></span>
                <span>${ratingKp}</span>
              </div>
            `
                : ""
            }
          </div>
          <div class="movie-info">
            <div class="movie-title">
              ${movie.name || movie.alternativeName || "–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è"}
            </div>
            <div class="movie-meta">
              <span class="movie-year">
                ${movie.year || "–ì–æ–¥ –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω"}
              </span>
              <span class="movie-genre">
                ${genres[0] || ""}
              </span>
            </div>
          </div>
        `;

        moviesContainer.appendChild(card);
      });

      gridCounter.textContent = `${docs.length} –Ω–∞–π–¥–µ–Ω–æ`;
    }

    async function loadPopular() {
      currentCategory = "popular";
      gridTitle.textContent = "–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ñ–∏–ª—å–º—ã";
      setActiveChip(btnPopular);

      try {
        showLoader();
        const data = await getMoviesList(
          {
            "rating.kp": "6-10",
            "votes.kp": "1000-100000000",
            sortField: "rating.kp",
            sortType: "-1",
          },
          1,
          24
        );

        renderMovies(data.docs || data.items || []);
      } catch (e) {
        console.error(e);
        showError("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ñ–∏–ª—å–º—ã");
      } finally {
        hideLoader();
      }
    }

    async function loadTop250() {
      currentCategory = "top250";
      gridTitle.textContent = "–¢–æ–ø 250 —Ñ–∏–ª—å–º–æ–≤";
      setActiveChip(btnTop250);

      try {
        showLoader();
        const data = await getMoviesList(
          {
            top250: "1-250",
            sortField: "top250",
            sortType: "1",
          },
          1,
          24
        );

        renderMovies(data.docs || data.items || []);
      } catch (e) {
        console.error(e);
        showError("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ç–æ–ø 250");
      } finally {
        hideLoader();
      }
    }

    async function loadNew() {
      currentCategory = "new";
      gridTitle.textContent = "–ù–æ–≤–∏–Ω–∫–∏ –∫–∏–Ω–æ";
      setActiveChip(btnNew);

      const currentYear = new Date().getFullYear();

      try {
        showLoader();
        const data = await getMoviesList(
          {
            year: `${currentYear - 1}-${currentYear}`,
            sortField: "year",
            sortType: "-1",
          },
          1,
          24
        );

        renderMovies(data.docs || data.items || []);
      } catch (e) {
        console.error(e);
        showError("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤–∏–Ω–∫–∏");
      } finally {
        hideLoader();
      }
    }

    async function loadRandom() {
      currentCategory = "random";
      gridTitle.textContent = "–°–ª—É—á–∞–π–Ω—ã–π —Ñ–∏–ª—å–º";
      setActiveChip(btnRandom);

      try {
        showLoader();
        const movie = await getRandomMovie();
        const docs = Array.isArray(movie)
          ? movie
          : movie.docs || movie.items || [movie];
        renderMovies(docs);
      } catch (e) {
        console.error(e);
        showError("–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Å–ª—É—á–∞–π–Ω—ã–π —Ñ–∏–ª—å–º");
      } finally {
        hideLoader();
      }
    }

    async function handleSearch() {
      const value = searchInput.value.trim();
      if (!value) {
        loadPopular();
        return;
      }

      currentCategory = "search";
      gridTitle.textContent = `–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞: ‚Äú${value}‚Äù`;
      setActiveChip(null);

      try {
        showLoader();
        const data = await searchMoviesByName(value, 1, 24);
        renderMovies(data.docs || data.items || []);
      } catch (e) {
        console.error(e);
        showError("–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –ø–æ–∏—Å–∫–∞");
      } finally {
        hideLoader();
      }
    }

    searchButton.addEventListener("click", (e) => {
      e.preventDefault();
      handleSearch();
    });

    searchInput.addEventListener("keydown", (e) => {
      if (e.key === "Enter") {
        handleSearch();
      }
    });

    btnPopular.addEventListener("click", (e) => {
      e.preventDefault();
      loadPopular();
    });

    btnTop250.addEventListener("click", (e) => {
      e.preventDefault();
      loadTop250();
    });

    btnNew.addEventListener("click", (e) => {
      e.preventDefault();
      loadNew();
    });

    btnRandom.addEventListener("click", (e) => {
      e.preventDefault();
      loadRandom();
    });

    loadPopular();
  </script>
</body>
</html>
