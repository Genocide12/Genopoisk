<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no, maximum-scale=1, minimum-scale=1">
  <meta name="theme-color" content="#000000">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Genopoisk">
  <meta name="yandex-verification" content="de26e5eef41c71ea" />
  <meta name="google-site-verification" content="Yd6LYUl97HtqaAmwgFf7BJIauzpoOLVc1epesFXZ890" />
  <title>Genopoisk — смотреть фильмы онлайн бесплатно в хорошем качестве</title>
  <meta name="description" content="Смотрите фильмы онлайн бесплатно на Genopoisk. Большой каталог фильмов в хорошем качестве: новинки, топ 250, популярные фильмы без рекламы.">
  <meta name="keywords" content="смотреть фильмы онлайн, фильмы бесплатно, кино в хорошем качестве, новинки кино, топ фильмов, кинопоиск, genopoisk, топ 250, смотреть кино без рекламы">
  <meta property="og:title" content="Genopoisk — смотреть фильмы онлайн бесплатно">
  <meta property="og:description" content="Большой каталог фильмов в хорошем качестве без рекламы">
  <meta property="og:image" content="https://genopoisk.vercel.app/icon-192.png">
  <meta property="og:url" content="https://genopoisk.vercel.app/">
  <meta property="og:type" content="website">
  <link rel="manifest" href="/manifest.json">
  <link rel="apple-touch-icon" href="/icon-192.png">
  <style>
    /* [ВСЕ СТИЛИ ОСТАЮТСЯ БЕЗ ИЗМЕНЕНИЙ - копируйте из вашего файла] */
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');
    *{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent;}
    :root{--ios-blue:#007AFF;--ios-purple:#5856D6;--ios-pink:#FF2D55;}
    /* ... остальные стили без изменений ... */
  </style>
</head>
<body>
  <!-- [HTML структура без изменений до скрипта] -->
  <div class="container">
    <!-- Hero, search, actions, content - БЕЗ ИЗМЕНЕНИЙ -->
  </div>
  
  <script>
    // ЗАЩИТА ОТ КОПИРОВАНИЯ И F12
    document.addEventListener('contextmenu', e => e.preventDefault());
    document.addEventListener('copy', e => e.preventDefault());
    document.addEventListener('cut', e => e.preventDefault());
    document.addEventListener('selectstart', e => e.preventDefault());
    document.onkeydown = function(e) {
      const key = e.key || '';
      if (e.ctrlKey && (key === 'c' || key === 'C' || key === 'x' || key === 'X' || key === 'u' || key === 'U' || key === 's' || key === 'S')) {
        e.preventDefault(); return false;
      }
      if (key === 'F12') { e.preventDefault(); return false; }
    };

    // === СИСТЕМА ЗАЩИЩЁННЫХ ССЫЛОК ===
    const SECRET_KEY = 'Genopoisk2026!x7K9pM2v'; // Меняйте при деплое
    
    function generateSecureLink(filmId, title) {
      const data = `${filmId}|${title}|${Date.now()}`;
      const hash = btoa(data + SECRET_KEY).slice(0, 16);
      const encodedData = btoa(data);
      return `player.html?p=${encodedData}&h=${hash}`;
    }

    function openPlayer(filmId, title) {
      const secureUrl = generateSecureLink(filmId, title);
      window.location.href = secureUrl;
    }

    // === API И ЛОГИКА ОСТАЁТСЯ БЕЗ ИЗМЕНЕНИЙ ===
    const API_KEY = '3698ed63-120c-4285-8071-2811619a0a7c';
    const API_BASE = 'https://kinopoiskapiunofficial.tech/api';
    
    // [Все остальные функции без изменений: apiGet, getPopular, getTop250, etc.]
    
    // ИЗМЕНЕНИЕ: в displayFilms замените card.addEventListener:
    card.addEventListener('click', () => {
      openPlayer(filmId, title); // Теперь использует защищённую ссылку
    });

    // [Остальной код без изменений]
  </script>
</body>
</html>
